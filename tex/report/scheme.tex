Our finite difference scheme is based on a scheme presented by Morten Lien Dahlby\cite{dahlby2007geometric}, and is a slight modification of the scheme presented by Holden and Raynaud\cite{holden2006convergence}. 

\begin{align}
m &= u - D_{-}D_{+}u, \\
m_t &= -D_{-}(m(u \vee 0)) -D_{+}(m(u \wedge 0)) - mD(u),
\end{align}
where $(u \vee 0) = \text{max}(u,0)$ and $(u \wedge 0) = \text{min}(u,0)$.

The original scheme by Holden and Raynaud used the $D_{-}$-operator, making it an upwind method. This would not work for antipeakons, peakons with negative height and speed. Modifying the scheme to use  $D_{-}$ when $u > 0$ and $D_{+}$ when $ u < 0$ makes it applicable to waves traveling in either direction. 

To find an appropriate temporal step, the Courantâ€“Friedrichsâ€“Lewy (CFL) condition was considered. The CFL condition is a necessary condition for stability in our finite difference scheme, and can be stated as

\begin{align}
C = \frac{u\Delta t}{\Delta x} \leq C_{\text{max}},
\end{align}
where $u$ is the velocity of the wave, $\Delta t$ is the length of the temporal step, and $\Delta x$ is the length of the spacial step. In our case, the value of $C_{\text{max}}$ was chosen to be 1. Rearranging this inequality gives an expression for $\Delta t$:
\begin{align}
\Delta t \leq \frac{\Delta x}{u}
\end{align}
The velocity $u$ was found by numerically calculating the integral of the initial function over the chosen interval, and the dividing this value by 2. This is done since the height of a peakon is 

%areaAbove = integral(@(x) max(initial(x), 0), xmin, xmax);
%areaBelow = - integral(@(x) min(initial(x), 0), xmin, xmax);
%A = max(areaAbove, areaBelow);
%c = A / 2;

% Use the CFL condition and assume the maximum height is equal to the
% velocity of the wave (assuming it is a wave).
% Multiply by a heuristic "goodness factor" to overestimate its maximum velocity.
%k = h / (1.1 * c);
